!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(n,s,function(e){return t[e]}.bind(null,s));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="dist/",i(i.s=1)}([function(t,e,i){},function(t,e,i){"use strict";i.r(e);i(0);function n(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e){var i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.currentPageNumb=0,this.requestValue=e,this.pageToken="",this.items=[],this.size=null,this.restOfClips=null,this.width=null,this.leftScroll=0,this.itemWidth=280,this.itemMarginRight=30,document.body.onresize=function(){i.setSize(document.body.offsetWidth),i.handleUsersActivity()},this.createItemsBoxDom(),this.createItemsWrapperDom(),this.createPaginator()}var e,i,s;return e=t,(i=[{key:"createInterface",value:function(t){this.addItems(t),this.setSize(document.body.offsetWidth),this.setMouseSwipe(),this.setMobileSwipe(),this.handleUsersActivity()}},{key:"createItemsBoxDom",value:function(){this.itemsBoxDom=document.createElement("div"),this.itemsBoxDom.id="itemsBoxDom"}},{key:"createItemsWrapperDom",value:function(){this.itemsWrapperDom=document.createElement("div"),this.itemsWrapperDom.id="itemsWrapperDom",this.itemsBoxDom.appendChild(this.itemsWrapperDom)}},{key:"createPaginator",value:function(){this.paginator=document.createElement("div"),this.paginator.id="paginator",this.itemsBoxDom.appendChild(this.paginator)}},{key:"addItems",value:function(t){var e=this;t.forEach(function(t){e.items.push(t);var i=function(t){var e=document.createElement("div");e.classList.add("itemDom");var i=document.createElement("a");i.href="https://youtube.com/watch?v=".concat(t.id),i.innerHTML=t.title,i.target="_blank",i.classList.add("itemTitle"),e.appendChild(i);var n=document.createElement("img");n.src=t.imageUrl,n.classList.add("itemImage"),e.appendChild(n);var s=document.createElement("div");s.classList.add("itemDate"),s.innerHTML=t.date,e.appendChild(s);var o=document.createElement("div");o.classList.add("itemChannel"),o.innerHTML="Канал: "+t.channelTitle,e.appendChild(o);var a=document.createElement("div");a.innerHTML=t.description.slice(0,160),a.classList.add("itemDescription"),e.appendChild(a);var r=document.createElement("div");r.classList.add("itemViewCount");var c=new Intl.NumberFormat("ru");r.innerHTML=c.format(t.viewCount),e.appendChild(r);var l=document.createElement("a");return l.classList.add("itemButton"),l.innerHTML="Перейти",l.href="https://youtube.com/watch?v=".concat(t.id),l.target="_blank",e.appendChild(l),e}(t);e.itemsWrapperDom.appendChild(i)})}},{key:"stopSwiping",value:function(){this.itemsWrapperDom.onmousedown=null,this.itemsWrapperDom.ontouchstart=null,document.body.onresize=null}},{key:"startSwiping",value:function(){var t=this;this.setMouseSwipe(),this.setMobileSwipe(),document.body.onresize=function(){t.setSize(document.body.offsetWidth),t.handleUsersActivity()}}},{key:"setSize",value:function(t){this.size=Math.max(1,Math.min(4,Math.floor(t/(this.itemWidth+this.itemMarginRight)))),this.width=this.size*(this.itemWidth+this.itemMarginRight)-this.itemMarginRight,this.itemsBoxDom.style.width="".concat(this.width,"px")}},{key:"handleUsersActivity",value:function(){var t=this;this.leftScroll=Math.ceil(this.leftScroll/this.size)*this.size,this.itemsWrapperDom.style.left="".concat(this.leftScroll*(this.itemWidth+this.itemMarginRight),"px"),this.currentPageNumb=Math.floor(-this.leftScroll/this.size),this.paginator.innerHTML="";for(var e=Math.floor(this.items.length/this.size),i=0;i<e;i++){var n=document.createElement("span");n.classList.add("pageCircle"),n.innerHTML=i+1,this.paginator.appendChild(n),i!==this.currentPageNumb&&(n.onclick=function(e){t.leftScroll=-(e.target.innerHTML-1)*t.size,t.itemsWrapperDom.style.left="".concat(t.leftScroll*(t.itemWidth+t.itemMarginRight),"px"),t.handleUsersActivity()}),i===this.currentPageNumb&&(n.style.color="red"),Math.abs(this.currentPageNumb-i)>2*this.size&&(n.style.display="none"),0===i&&(n.style.display="inline-block",Math.abs(this.currentPageNumb-i)>2*this.size+1&&n.classList.add("firstPage")),i===e-1&&(n.style.display="inline-block",Math.abs(this.currentPageNumb-i)>2*this.size+1&&n.classList.add("lastPage"))}this.restOfClips=this.items.length-this.size+this.leftScroll,this.restOfClips<this.size&&this.makeRequest()}},{key:"setMouseSwipe",value:function(){var t=this,e=this.itemsWrapperDom,i=0;e.ondragstart=function(){return!1},e.onmousedown=function(n){var s=t.leftScroll,o=n.pageX;e.onmousemove=function(n){i=n.pageX-o;var a=function(){i=t.size*Math.sign(i)*(Math.abs(i)>20?1:0),t.leftScroll=Math.min(0,s+i),new Promise(function(e){t.handleUsersActivity(),e()}).then(function(){e.style.left="".concat(t.leftScroll*(t.itemWidth+t.itemMarginRight),"px")}),e.onmousemove=null,e.onmouseleave=null,window.onmouseup=null};e.onmouseleave=a,window.onmouseup=a},e.onmouseup=function(){e.onmousemove=null}}}},{key:"setMobileSwipe",value:function(){var t=this,e=this.itemsWrapperDom;e.ontouchstart=function(i){var n=t.leftScroll,s=i.touches[0].pageX;e.ontouchmove=function(i){var o=i.touches[0].pageX-s;e.ontouchend=function(){o=Math.abs(o)>10?t.size*Math.sign(o):0,t.leftScroll=Math.min(0,n+o),e.ontouchend=null,e.ontouchmove=null,new Promise(function(e){t.handleUsersActivity(),e()}).then(function(){e.style.left="".concat(t.leftScroll*(t.itemWidth+t.itemMarginRight),"px")})}}}}},{key:"makeRequest",value:function(){var t,e,i,n,s=this;this.stopSwiping(),(t=this.requestValue,e=this.pageToken,i={},n=function(t,e,i,n){return"https://www.googleapis.com/youtube/v3/".concat(e,"?key=AIzaSyCTWC75i70moJLzyNh3tt4jzCljZcRkU8Y&type=video&part=").concat(t,"&maxResults=8&q=").concat(i,"&pageToken=").concat(n)}("snippet","search",t,e),fetch(n).then(function(t){return t.json()}).then(function(t){i.pageToken=t.nextPageToken,i.itemsArr=t.items.map(function(t){return{title:t.snippet.title,date:new Date(Date.parse(t.snippet.publishedAt)).toDateString(),description:t.snippet.description,channelId:t.snippet.channelId,channelTitle:t.snippet.channelTitle,id:t.id.videoId,imageUrl:t.snippet.thumbnails.medium.url}});var e=function(t,e){return"https://www.googleapis.com/youtube/v3/videos?key=AIzaSyCTWC75i70moJLzyNh3tt4jzCljZcRkU8Y&id=".concat(t,"&part=").concat(e)}(i.itemsArr.reduce(function(t,e,i){return t+=(0===i?"":",")+e.id},""),"snippet,statistics");return fetch(e)}).then(function(t){return t.json()}).then(function(t){var e=t.items;return i.itemsArr.forEach(function(t,i){t.viewCount=e[i].statistics.viewCount}),i})).then(function(t){s.pageToken=t.pageToken,0===s.items.length?s.createInterface(t.itemsArr):s.items.length>0&&s.addItems(t.itemsArr),s.startSwiping(),s.handleUsersActivity()})}}])&&n(e.prototype,i),s&&n(e,s),t}();!function(){var t=document.createElement("div");t.id="searchBox";var e=document.createElement("input");e.id="searchField",t.appendChild(e);var i=document.createElement("input");i.type="button",i.value="=>",i.id="searchButton",t.appendChild(i),document.body.appendChild(t),e.onfocus=function(){e.style.background="white"},e.onblur=function(){e.style.background="lightgray"}}();var o=document.getElementById("searchField"),a=document.getElementById("searchButton"),r=document.createElement("div");document.body.appendChild(r),a.onclick=function(){r.innerHTML="";var t=new s(o.value);r.appendChild(t.itemsBoxDom),t.makeRequest()}}]);
